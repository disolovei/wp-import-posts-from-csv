<?php

defined( 'ABSPATH' ) || exit;

final class Google_Sheet_To_Posts {

	const ADMIN_PAGE_SLUG = 'google_sheet_to_posts';

	protected static $instance = null;

	protected $loader = null;

	protected $config = null;

	protected $blogs = null;

	public static function get_instance() {
		if ( null === self::$instance ) {
			self::$instance = new self();
		}

		return self::$instance;
	}

	public function get_config() {
		return $this->config;
	}

	public function admin_menu() {
		add_menu_page(
			'Export Posts From CSV',
			'Export From CSV',
			'manage_options',
			Google_Sheet_To_Posts::ADMIN_PAGE_SLUG,
			[GSTP_Template::class, 'settings_page'],
			GSTP_URL . 'assets/images/gstp.svg'
		);
	}

	public function register_settings() {
		$settings_section_id    = 'google_sheet_to_posts_section';
		$setting_group_name     = GSTP_Helper::get_settings_group_name();

		add_settings_section(
			$settings_section_id,
			'Credentials',
			[GSTP_Template::class, 'credentials_notice'],
			Google_Sheet_To_Posts::ADMIN_PAGE_SLUG
		);

		add_settings_field(
			'google_sheet_to_posts_client_id',
			'Client ID',
			function( $args = [] ) {
				?>

				<input type="text" required name="google_sheet_to_posts_client_id" value="<?php echo esc_attr( $this->config->get_client_id() ); ?>">&nbsp;&nbsp;
				<img style="display:inline-block;vertical-align:middle;height:30px;width:auto;" src="data:image/png;base64,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" />

				<?php
			},
			Google_Sheet_To_Posts::ADMIN_PAGE_SLUG,
			$settings_section_id
		);

		add_settings_field(
			'google_sheet_to_posts_api_key',
			'API Key',
			function( $args = [] ) {
				?>

				<input type="text" required name="google_sheet_to_posts_api_key" value="<?php echo esc_attr( $this->config->get_api_key() ); ?>">&nbsp;&nbsp;
				<img style="display:inline-block;vertical-align:middle;height:30px;width:auto;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJwAAAAsCAIAAAAfEEZvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAHJ0lEQVR4nO2cfVAU5xnAn73du929j73j4zikSYsklUYwgxZorKUlRhK1NhcUhDRKA4lpxZlMOyZTLcY4NBi10JnUUG0MkqjFWhOtiWmiTm3jFyJOKipW4gcqXL0IHNwHd7u3X/3jLgeSPdHAkrjd39wfd7vv7j63v3uf5913dw4RRRFUlIXmqw5AZfRRpSoQVaoCwaKtOHCOqT3Y3+bkPLRadL92UASSmogtmW7Im4h/cS0iOVD66CzzzFt98semMlLqnrbMTB/qVTr91h7slz8elVFA0pS01As3OJmDURkdJE1JS/WqdfQuQdKUOvpVIKpUBaJKVSCqVAWiSlUgqlQFokpVIGMh9cF7sD8uMH+y0tq+1nZ0eXzFj40UgYzBcaOxOFfvqLa9UWIZvHDuFMJRbQu92qoSNi402ygNAIwzaxzVttJp+sGN52eSjmpbchw6pnHfNlEn9EeL4mxybQHV4eIbmgLdXmFCIlb2A0N2is6+3jXynR9dHt/SwZZvc9/RVoWZJM1BXhoeo0d6/TddvK/90Od0C3FGZHGuoeG5mLyanpEHOfbIK/WBcdiaedSHZ+jnG9xBPrxwyzE/JwydB8E0wAmyxhIm415taiK26j3vyp+Y8qeQm4/4B6/d18q0OTkA6OwVNi40T71Pd7nr7psxlTf9PpujZ3nxxZ2eiFEAOO/kLt7g4fMk9kyOvnmF9eo6W4wBiTEgvy+izlYmtFUlvFVm+WZsOL/ZJxMHlsZdXmM7UWFdMcekQ8NZMTkOtWcQjmrbwqkkAKQlYX95LubC6oSWVdZX8k2EViKkomzSS4tbj/mPXgwWZZPRIu/y8gBg0A1fJuwZxLV1tt8VUgAgGf+fSiyfViUY8fCu5jyIO6ptsydJ3DIbLeSVmn6P9lQHe+uZ5EU5+opdntLNfSwn7vh57A8n4Ct2e8q3ue+NRXcujiV1iIVEKu2mU9fYJ99w/bnJ/4sf6Zc+ZuzxCQUbep0e4ejFYMGG3v2tzLfi0F1LYgktsujtvlf2egu+S772pGXIsXAM7BnE+y00zcE7JwPpSVha0k25KkaPWE2a1ERs2SyTlxab2oO3/oL2ycT6n5q3Hve/uNOjRUEy/o3/6jfgSOQHVPJ9fYeL/+gsc+en83aRN/0iAMM+17Zyj3f/OQYAZk3C05Kwkrq+f/yHAYD2Lu7wsviZ6fjuT+gZNT1dXgEAmi6zWcm63FT81b/7Gi8FaVbs9gmNl4IA8NsnTBiKlNb3hsqkDkPWzqPGmTXX3QNpfeYkwkwiB84xMQak8XKQ5qA4m3zpb95Ig3fLY0NvenzCoi197oCoj95Z86cQv8oz7mgOVOzyAsCMiVHjb25nS6fp6w7777Oi0+7XrXrP+4X6M5rIK/VMJ/t4BmEikFt01gufhYtWihUDgNqnzIObplgxBIGiLHLWJDzJgjrdgpFANFLnOcWK6VA49htr6COKAILA+HjsunugtxVlkgBQXzrQg/Mnk5Xve9nPq8Ov3/F09vI+WjzdyQ4uGZK88JiR4cIRimLU+AFg48f9dU9bHv6OLjcV9zHi9qbAMLseGfJK3XzEX5BJriuknm9wR05cchw6YyL+5uHwCCXSla92cwBQVt93zRVuSmjhhkcoziaXzza+vMf7z/OMRa+pfMJk0Wsi20YEX+nhHvBi+bUuXgAA0KHAi+B0D5gZZ9bkTNBtOx7Y20KHlqRY0dVzqUfT8A9Oh5Nh8xU2NFC6HV4/2N/SwW76meXZHP2mQ/5o8QPAvlamvZsvf9iQlqTd3hTwMfLe2ZRXaut/uWXvetbMo9KWave00N1efkIiNj+T9DFi5MxG2N/KtDm5NfOoDR/3+4PirHQ8NxV/pKab0CIAcMbBXu3hk+Ox+xOwbl84o153899L0RVnk586uc2H/fMzydVzqR0nAgYCKZmqB4A5fxi4JinMJDUIbDrUHxqmAcCRi/DLPGNRFhmRekdsbwpc6eH3nKKXzTYdPM9Ei99Di6IIbx7yV801CSLU3TzelgPZJx+2NwUeX9/Tep1d8BC5yk7lpuJbGwOPVHc7PUOvYII8FGxwnbwarJhtqimkEim0rL7P0Ss0HPdvaQy8/pTl3y8nLHiIPHmFjWxStdfn9ouVdtN4K3qpi8+vdaEI1BRRL80xdbj4RW/38YMOMj+LjAy8Q4gifNBC56bioXmGL0fFbo+PFl4rNnOCdPyhZn89GeAE2HeW6XANl9ZHjPSDZ9944TO5D/z/xqMT8foyS36t60Q7O3zrO8FRbRuyRJ37HSPKpxtOd3KjblQSVepYkDVem5Ws3XRojJ7RlH3uVwUAmtvZsaxoak9VIKpUBaJKVSCqVAWiSlUgqlQFIi3V9JU+Q6Ry+0iakpb67QT1+vXuQNKUtNQl0w0yB6MyOkiakp7QB/XvAb7efJm/B1C5q1FHvwpElapAVKkK5H8C8AhgzRr8WQAAAABJRU5ErkJggg==" />

				<?php
			},
			Google_Sheet_To_Posts::ADMIN_PAGE_SLUG,
			$settings_section_id
		);

		add_settings_field(
			'google_sheet_to_posts_sheet_id',
			'Sheet ID',
			function( $args = [] ) {
				?>

				<input type="text" required name="google_sheet_to_posts_sheet_id" value="<?php echo esc_attr( $this->config->get_sheet_id() ); ?>">&nbsp;&nbsp;
				<img style="display:inline-block;vertical-align:middle;height:30px;width:auto;" src="data:image/png;base64,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" />

				<?php
			},
			Google_Sheet_To_Posts::ADMIN_PAGE_SLUG,
			$settings_section_id
		);

		add_settings_field(
			'google_sheet_to_posts_sheet_name',
			'Sheet Name',
			function( $args = [] ) {
				?>

				<input type="text" required name="google_sheet_to_posts_sheet_name" value="<?php echo esc_attr( $this->config->get_sheet_name() ); ?>">&nbsp;&nbsp;
				<img style="display:inline-block;vertical-align:middle;height:30px;width:auto;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANAAAAAuCAIAAADWXgBKAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEoklEQVR4nO3cb0wbZRwH8F97Ddd2pcj400Zgxa4FSpvZ1MzggAFTIoIZqBF84/YC98KFLPXNFmN8s2AMS0xwGn3hi4XFROdiDGYszCE6wtxmGCGuuI3xAqQkY7XdGIxwpA2+6N316Lq2i3fPcfT3eXXP3fX4HXzvuT7Xp6impmdAafJO9m4/2St3FSiZ0BFv8Ij38fUqJQbObiuVuwSUWsLMqWUpBWWChHchDfk6xHVHgT00LwO7asUHbitR9MXDS34VqdbX10lVIh6VKrasxPp5whMBhZ8LL+lfR7MQCBGtRgwmwbIS6+eZNjYfLj+Spw5RGQXL83cDlFqtEkRQo9PR5GsS1xY4hSijYZvcJYhMp82iKEoYOBylIgk9/oYNA4ekFZc5DBwiCgOHiMLAIaIwcIgoDBwiCgOHiMLAIaIwcIgoDBwiCgOHiIrNh/vw2FEA+LTnhCjHjR4tObF+1tMK3zz3xdDchlU7Gt5vrdA+/OvbvssBdhWlzy/x7KnbbdGTrzBNqxPeiv5rDAAA0JShJN/TVNXZ5S7LYbdPfdJ78MtF4SvMXZ0/fVRMuk6hjJ2AqbO8sLs8l2Jb+me13AajtbrKmhUJP5jzTY4OnFt9u722QKYa07K9qfpwaz4wy7PXpy+e7j84eOv4j+80FnKbaVNbT5WLm05jsOXLVCZHqsDJ1XuljS6wO52JkqQvsjkdegDYZc1e6RuZ8i3UNpgS7LdZZHtcLW1mAICOms4Dox+89euJYxOeU+48drvB0+pu1CY5AFlSBW4z31LTRetpgHA4LHcd6aNdNYcPjB36ZmzknvuNwtT7y0ATlwxhc7MH4n+JMCsrj9gJthS9jeavvEh4ZZWhIsyS/9rVmYhuZ1mK7u3vm7cvDA3HrXRUlDc17hO55LTYPeYsxj81DcAGLrwWWA5Gb6m0xpCjTTZZ9czEgLe/O25l+/PNn7d9LFZ9GXtLXbrxc98Ndjmrcn/nqxa2Ebhy9usrAABAZVtqX3vZkuJXVOkoBwBh5uRLWwLMbPeLn7HLdNHRP99L1vN1uFsAQJg5cdMGABo+GZkzSgUAAN3O+n272On3lNEc25Bb8Up98dzvQ7cZ695mtymddz/CzMmdtjvjd9foZ8psXJsuevdUvYft1rR245NexxFmTvS0QQaPUulc847SRIMGuqCo1PFc8/1/v78+/Iu1fX9ZWo9Fopn7xz8va9oY3+hXpxcNDfV7Y92Y1v6SreqpBg3RzP0xMy562iCDb6nJaQr3NNb4z176bXjS/LozZbcAAACVjvJo7MhaGvcNnPEDszrru3Xxh/lQifN4Dz9EBYAHV/vH1riGwemqc6WRvg53SzR2osNR6pPkepqqZ74buTQ0WfymMyf1/nIJDV7uHuQe/B5qFT74BQBggue9A+e5lrnLXOeS9cGvanFpWYrjSho4Y7aBX164F1Tu1wSFJwKwBb8IHQzdpyhKrY59gipV4CSFgdvUkgYOP7xHRGHgEFEYOEQUBg4RhYFDRGHgEFEYOEQUBg4RhYFDRGHgEFEYOEQUBg4RpfgJmKbCvNQ7KUXcf9HfirCHQ9JSbbyK/gMxEUq4gIVfGwAAAABJRU5ErkJggg==">

				<?php
			},
			Google_Sheet_To_Posts::ADMIN_PAGE_SLUG,
			$settings_section_id
		);

		register_setting( $setting_group_name, 'google_sheet_to_posts_client_id' );
		register_setting( $setting_group_name, 'google_sheet_to_posts_api_key' );
		register_setting( $setting_group_name, 'google_sheet_to_posts_sheet_id' );
		register_setting( $setting_group_name, 'google_sheet_to_posts_sheet_name' );
	}

	public function get_blogs() {
		if ( ! is_array( $this->blogs ) ) {
			$this->blogs = GSTP_Helper::get_sites();
		}

		return $this->blogs;
	}

	public function is_ready() {
		return $this->config->get_client_id() && $this->config->get_api_key() && $this->config->get_sheet_id() && $this->config->get_sheet_name();
	}

	protected function __construct() {
		$this->config = new GSTP_Config();

		add_action( 'admin_menu', [$this, 'admin_menu'] );
		add_action( 'admin_init', [$this, 'register_settings'] );
		add_action( 'admin_enqueue_scripts', [$this, 'enqueue_scripts'] );

		new GSTP_Shortcode();

		new GSTP_AJAX();
	}

	public function enqueue_scripts() {
		if ( ! isset( $_GET['page'] ) || Google_Sheet_To_Posts::ADMIN_PAGE_SLUG !== $_GET['page'] ) {
			return;
		}

		if ( ! isset( $_GET['tab'] ) || 'file-reader' === $_GET['tab'] ) {
			wp_enqueue_script( 'jquery-csv', GSTP_URL . 'assets/js/modules/jquery.csv.min.js', ['jquery'], '0.8', true );
			wp_enqueue_script( 'gstp', GSTP_URL . 'assets/js/gstp.js', ['jquery-csv'], '0.8', true );
		} elseif ( 'api-reader' === $_GET['tab'] ) {
			wp_enqueue_script( 'gapi', 'https://apis.google.com/js/api.js', [], '0.8', true );
			wp_enqueue_script( 'gstp', GSTP_URL . 'assets/js/gstp.js', ['jquery', 'gapi'], '0.8', true );
			wp_localize_script( 'gstp', 'GSTPAPI', [
				'API_KEY'		=> $this->config->get_api_key(),
				'CLIENT_ID'		=> $this->config->get_client_id(),
				'SHEET_ID'		=> $this->config->get_sheet_id(),
				'SHEET_NAME'	=> $this->config->get_sheet_name(),
			] );
		}
	}
}

function GSTP() {
	return Google_Sheet_To_Posts::get_instance();
}
